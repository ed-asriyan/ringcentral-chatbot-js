<!DOCTYPE html>
<html lang="en">
  <head>
    <script>
      // Hack for scrolling window when linking to anchor tag with fixed nav header
      var shiftWindow = function() { scrollBy(0, -75) };
      window.addEventListener("hashchange", shiftWindow);
      function load() { if (window.location.hash) shiftWindow(); }
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://ringcentral.github.io/ringcentral-chatbot-js/developers/lambda/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <title>Deploying to AWS Lambda - RingCentral Chatbot Framework for Javascript</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css" rel="stylesheet">
    <link href="../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../css/code-styles.css" rel="stylesheet">
    <link href="../../css/mega-menu.css" rel="stylesheet">
    <link href="../../css/code-tabs.css" rel="stylesheet">
    <link href="../../css/admonition.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="../../fonts.js"></script> 
  </head>
  
  <body class="" data-spy="scroll" data-target="#toc">
    <nav class="navbar navbar-expand-md navbar-light sticky-top">
  <div class="container">
    <a class="navbar-brand" href="../..">
      <img src="../../logo_beta.svg" />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav mr-auto mx-auto">
        <li id="products-dropdown" class="main-item nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Products</a>
          <div id="mega-menu-products" class="dropdown-menu mega-menu" role="menu" aria-labelledby="navbarDropdown">
	    <div class="row">
              <div class="col-md-3">
                <ul>
                  <li class="sub-menu-heading">APIs</li>
                  <li><a href="https://developer.ringcentral.com/api-products/voice">Voice</a></li>
                  <li><a href="https://developer.ringcentral.com/api-products/sms">SMS</a></li>
                  <li><a href="https://developer.ringcentral.com/api-products/fax">Fax</a></li>
                  <li><a href="https://developer.ringcentral.com/api-products/team-messaging">Chat</a></li>
                  <li><a href="https://developer.ringcentral.com/api-products/meetings">Meetings</a></li>
                  <li><a href="https://developer.ringcentral.com/api-products/data">Call Log</a></li>
<!-- TODO: Change "Configuration" to "Account"?
                  <li><a href="https://developer.ringcentral.com/api-products/configuration">Configuration</a></li>
-->
                </ul>
              </div>
              <div class="col-md-3">
                <ul>
                  <li class="sub-menu-heading">Widgets</li>
                  <li><a href="https://developer.ringcentral.com/embeddable-voice.html">RingCentral Embeddable</a></li>
                </ul>
                <ul>
                  <li class="sub-menu-heading">Bots</li>
                  <li><a href="https://developer.ringcentral.com/library/chatbots.html">SMS Bot Framework</a></li>
                  <li><a href="https://developer.ringcentral.com/library/chatbots.html">Chat Bot Framework</a></li>
                </ul>
              </div>
              <div class="col-md-3">
                <img src="https://images.ctfassets.net/up8h5u10ttz3/69wfSTqwkowM2ySYouo2qU/da9f91e31b1a4266552181e29e9938db/platformsignup.png" width="100%">
              </div>
	    </div> 
          </div>
        </li>
        <li class="main-item nav-item dropdown" id="resources-dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
          <div id="mega-menu-resources" class="dropdown-menu mega-menu" aria-labelledby="navbarDropdown">
	    <div class="row">
              <div class="col-md-3">
                <ul>
                  <li class="sub-menu-heading">Docs</li>
                  <li><a href="../../get-started/">Getting Started</a></li>
                  <li><a href="../..">Developer Guide</a></li>
                  <li><a href="http://ringcentral-api-changelog.readthedocs.io/en/latest/">Changelog</a></li>
                </ul>
<!--
		<ul>
                  <li class="sub-menu-heading">Downloads</li>
                  <li><a href="https://developer.ringcentral.com/library/sdks.html#">SDKs</a></li>
		</ul>
-->
                <ul>
                  <li class="sub-menu-heading">Use Cases</li>
                  <li><a href="https://www.ringcentral.com/whyringcentral/casestudies.html?integrations=API">Case Studies</a></li>
                  <li><a href="https://www.ringcentral.com/resources/learning-center.html#whitepapers">White papers</a></li>
                </ul>
              </div>
              <div class="col-md-3">
                <ul>
                  <li class="sub-menu-heading">API Reference</li>
                  <li><a href="https://developer.ringcentral.com/api-reference#Call-Log">Call Log</a></li>
                  <li><a href="https://developer.ringcentral.com/api-reference#RingOut">RingOut</a></li>
                  <li><a href="https://developer.ringcentral.com/api-reference#SMS-and-MMS">SMS</a></li>
                  <li><a href="https://developer.ringcentral.com/api-reference#Chats">Glip</a></li>
                  <li><a href="https://developer.ringcentral.com/api-reference#Upcoming-Meetings">Meetings</a></li>
                  <li><a href="https://developer.ringcentral.com/api-reference#Fax">Fax</a></li>
		  <li></li>
                  <li><a class="mega-menu-link" href="https://developer.ringcentral.com/api-reference">API Explorer &raquo;</a></li>
                </ul>
              </div>
              <div class="col-md-2">
                <ul>
                  <li class="sub-menu-heading">SDKs</li>
                  <li><a href="https://github.com/ringcentral/ringcentral-csharp-client">C#</a></li>
                  <li><a href="https://github.com/ringcentral/ringcentral-swift">iOS/Swift</a></li>
                  <li><a href="https://github.com/ringcentral/ringcentral-js">Javascript</a></li>
                  <li><a href="https://github.com/ringcentral/ringcentral-java">Java</a></li>
                  <li><a href="https://github.com/ringcentral/ringcentral-php">PHP</a></li>
                  <li><a href="https://github.com/ringcentral/ringcentral-python">Python</a></li>
                  <li><a href="https://github.com/ringcentral/ringcentral-ruby">Ruby</a></li>
		  <li></li>
                  <li><a class="mega-menu-link" href="https://developer.ringcentral.com/library/sdks.html">All SDKs &raquo;</a></li>
                </ul>
              </div>
              <div class="col-md-4">
                <img src="https://images.ctfassets.net/up8h5u10ttz3/29HlpFhK362Y00MseE8Oek/2a401f3ca6a6fa32cdf95104cebdc728/award2.png" width="100%">
              </div>
	    </div> 
          </div>
        </li>
        <li class="main-item nav-item dropdown" id="community-dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Community</a>
          <div id="mega-menu-community" class="dropdown-menu mega-menu" aria-labelledby="navbarDropdown">
	    <div class="row">
              <div class="col-md-3">
                <ul>
                  <li class="sub-menu-heading">Discuss</li>
                  <li><a href="https://devcommunity.ringcentral.com/">Developer Forum</a></li>
                  <li><a href="http://stackoverflow.com/questions/tagged/ringcentral">Stack Overflow</a></li>
                  <li><a href="https://developer.ringcentral.com/community.html">Glip</a></li>
                </ul>
                <ul>
                  <li class="sub-menu-heading">Learn</li>
                  <li><a href="https://medium.com/ringcentral-developers">Blog</a></li>
                  <li><a href="https://developer.ringcentral.com/support/developer-events.html">Events</a></li>
                  <li><a href="https://go.ringcentral.com/Developer-Webinar-Series-Registration.html">Webinars</a></li>
                </ul>
              </div>
              <div class="col-md-3">
                <ul>
                  <li class="sub-menu-heading">Partner</li>
                  <li><a href="https://www.ringcentral.com/apps/">App Gallery</a></li>
                  <li><a href="https://www.ringcentral.com/partner/isv.html">Partner Programs</a></li>
                </ul>
                <ul>
                  <li class="sub-menu-heading">Follow</li>
                  <li><a href="https://twitter.com/RingCentralDevs">Twitter</a></li>
                  <li><a href="https://github.com/ringcentral/">Github</a></li>
                  <li><a href="https://www.youtube.com/watch?v=H4n-7dBFTEc&list=PLpfipw7KaEwagUy8S4Za25usqFg4bWiAx">YouTube</a></li>
                </ul>
              </div>
              <div class="col-md-3">
                <img src="https://images.ctfassets.net/up8h5u10ttz3/29HlpFhK362Y00MseE8Oek/2a401f3ca6a6fa32cdf95104cebdc728/award2.png" width="100%">
              </div>
	    </div> 
          </div>
        </li>
        <li class="main-item nav-item dropdown" id="support-dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Support</a>
          <div id="mega-menu-support" class="dropdown-menu mega-menu" aria-labelledby="navbarDropdown">
	    <div class="row">
              <div class="col-md-6">
                <ul>
                  <li class="sub-menu-heading">Support</li>
                  <li><a href="http://ringcentral-faq.readthedocs.io/">FAQs</a></li>
                  <li><a href="https://devcommunity.ringcentral.com/">Developer Forum</a></li>
                  <li><a href="#">Create a ticket</a></li>
                  <li><a href="#">View your tickets</a></li>
                </ul>
                <ul>
                  <li class="sub-menu-heading">Professional Services</li>
                  <li><a href="https://developer.ringcentral.com/support/services.html">Let us build the perfect app for you</a></li>
                </ul>
              </div>
              <div class="col-md-3">
                <img src="https://images.ctfassets.net/up8h5u10ttz3/1nEecYNk3CeSYKCUMyWOUk/57ab94c71c56819a3ae2021a3ad75138/pro_services.png" width="100%">
              </div>
	    </div> 
          </div>
        </li>
      </ul>
      
      <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
        <li class="nav-item">
          <a class="nav-link" href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
	    <i class="fa fa-search"></i> Search
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/byrnereese/ringcentral-chatbot-js/edit/master/docs/developers/lambda.md"><i class="fa fa-github"></i> Edit on GitHub</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div id="content"class="container">
      
    <div class="row flex-nowrap">
      <div id="sidebar-nav" class="sidebar col-md-3"><nav id="sidenav" class="nav-collapse" data-toggle="collapse" data-target=".nav-collapse.show">
  <div class="container">
    <!-- Main navigation -->
    <ul class="nav navbar-nav">
      <li >
        <a class="nav-link" href="../..">Home</a>
      </li>
      <li >
        <a class="nav-link" href="../get-started/">Getting Started</a>
      </li>
      <li >
        <a class="nav-link" href="../bots/">Building Bots</a>
      </li>
      <li >
        <a class="nav-link" href="../structure/">Project Structure</a>
      </li>
      <li class="active">
        <a class="nav-link" href="./">Deploying to AWS Lambda</a>
      </li>
      <li >
        <a class="nav-link" href="../skills/">Developing "Skills"</a>
      </li>
      <li >
        <a class="nav-link" href="../maintain/">Bot Maintenance</a>
      </li>
      <li >
        <a class="nav-link" href="../../samples/">Sample Bots</a>
      </li>
      <li >
        <a class="nav-link" href="../../about/">About</a>
      </li>
    </ul>
  </div>
</nav>
</div>
      <div id="main" class="col-md-7" role="main">



<h1 id="deploying-a-bot-to-aws-lambda">Deploying a Bot to AWS Lambda</h1>
<p>This guide will take you through the process of deploying and hosting your bot on AWS Lambda. We recommend you do the following prior to reading this guide:</p>
<ol>
<li>Successful test your bot locally using the instructions in our <a href="../get-started">Getting Started Guide</a>.</li>
<li>Familiarize yourself with our <a href="../structure">recommended project structure</a>.</li>
</ol>
<p>When you are ready, Let's begin.</p>
<h2 id="install-dependencies">Install dependencies</h2>
<p>To get started let's add some key dependencies to our project. </p>
<div class="codehilite"><pre><span></span>yarn add ringcentral-chatbot serverless-http pg
yarn add --dev serverless
</pre></div>

<ul>
<li>
<p>We installed <code>pg</code> because we choose to use PostgreSQL as our database in this example, but you are welcome to use any database you wish. </p>
</li>
<li>
<p>We use <code>serverless-http</code> to use Express.js code in AWS Lambda so that we can reuse code between Express.js and AWS Lambda.</p>
</li>
<li>
<p>We use <code>serverless</code> framework to help us deploy the project to AWS with ease.</p>
</li>
</ul>
<h2 id="code-the-bot">Code the Bot</h2>
<p>Nothing requires you to structure your project according to <a href="../structure">our recommendation</a>. In the example below we encapsulate our entire bot in a single file <code>lambda.js</code> to more easily illustrate AWS deployment. </p>
<p>Create and edit a file called <code>lambda.js</code> with the following content:</p>
<div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">createApp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;ringcentral-chatbot/dist/apps&#39;</span><span class="p">).</span><span class="k">default</span>
<span class="kr">const</span> <span class="p">{</span> <span class="nx">createAsyncProxy</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;ringcentral-chatbot/dist/lambda&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">serverlessHTTP</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;serverless-http&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">handle</span> <span class="o">=</span> <span class="nx">async</span> <span class="nx">event</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">group</span><span class="p">,</span> <span class="nx">bot</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">event</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;Message4Bot&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">text</span> <span class="o">===</span> <span class="s1">&#39;ping&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">await</span> <span class="nx">bot</span><span class="p">.</span><span class="nx">sendMessage</span><span class="p">(</span><span class="nx">group</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="p">{</span> <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;pong&#39;</span> <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">createApp</span><span class="p">(</span><span class="nx">handle</span><span class="p">)</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">app</span> <span class="o">=</span> <span class="nx">serverlessHTTP</span><span class="p">(</span><span class="nx">app</span><span class="p">)</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">proxy</span> <span class="o">=</span> <span class="nx">createAsyncProxy</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">)</span>
</pre></div>

<h2 id="create-and-setup-your-database">Create and Setup Your Database</h2>
<p>If you have access to a MySQL or PostgreSQL database you are free to use that. If you do not, you can use AWS's RDS service to create one through the following steps:</p>
<ol>
<li>Login to the AWS Console and navigate to RDS. </li>
<li>Create a PostgreSQL database.</li>
<li>Configure the security group so that it is publicly accessible with username and password.</li>
</ol>
<p>Take a note of the database uri, database name, username and password, we will use them soon.</p>
<div class="admonition warning">
<p class="admonition-title">Database Security Group Rules</p>
<p>Be sure to configure your Security Group Rules so that your database is accessible from the outside. Your rules should look like this:</p>
<p><img src="../security-group.png" class="img-fluid"></p>
</div>
<h2 id="create-envyml">Create .env.yml</h2>
<p>Create a file called <code>.env.yml</code> with the following properties (use <a href="https://github.com/tylerlong/ringcentral-chatbot-js/blob/master/.lambda.env.yml">this template</a> to help):</p>
<table class="table">
<thead>
<tr>
<th scope="col">Property</th>
<th scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RINGCENTRAL_SERVER</code></td>
<td>Use https://platform.dev.ringcentral.com for sandbox and https://platform.ringcentral.com for production</td>
</tr>
<tr>
<td><code>RINGCENTRAL_CHATBOT_DATABASE_CONNECTION_URI</code></td>
<td>please sepcify connection URI to a relational database. SQLite, MySQL and PostgreSQL are supported. We specify the AWS RDS we created above.</td>
</tr>
<tr>
<td><code>RINGCENTRAL_CHATBOT_CLIENT_ID</code></td>
<td>Retrieve from the RingCentral Developer Console.</td>
</tr>
<tr>
<td><code>RINGCENTRAL_CHATBOT_CLIENT_SECRET</code></td>
<td>Retrieve from the RingCentral Developer Console.</td>
</tr>
<tr>
<td><code>RINGCENTRAL_CHATBOT_SERVER</code></td>
<td>We don't know until we deploy the project to AWS, let's specify a dummy one for now: https://xxxxxx.execute-api.us-east-1.amazonaws.com/prod</td>
</tr>
<tr>
<td><code>RINGCENTRAL_CHATBOT_ADMIN_USERNAME</code></td>
<td>An admin username of your choice.</td>
</tr>
<tr>
<td><code>RINGCENTRAL_CHATBOT_ADMIN_PASSWORD</code></td>
<td>An admin password of your choice.</td>
</tr>
</tbody>
</table>
<h2 id="create-serverlessyml">Create serverless.yml</h2>
<p>Create <code>serverless.yml</code> with following content:</p>
<div class="codehilite"><pre><span></span><span class="nt">service</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">demo-ping-chatbot</span>
<span class="nt">provider</span><span class="p">:</span>
  <span class="nt">stage</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${opt:stage, &#39;prod&#39;}</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">aws</span>
  <span class="nt">runtime</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nodejs8.10</span>
  <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
  <span class="nt">memorySize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">256</span>
  <span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${file(./.env.yml)}</span>
  <span class="nt">iamRoleStatements</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">Effect</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Allow</span>
      <span class="nt">Action</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">lambda:InvokeFunction</span>
      <span class="nt">Resource</span><span class="p">:</span> <span class="s">&quot;*&quot;</span>
<span class="nt">package</span><span class="p">:</span>
  <span class="nt">exclude</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./**</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;!lambda.js&#39;</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;!node_modules/**&#39;</span>
  <span class="nt">excludeDevDependencies</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">functions</span><span class="p">:</span>
  <span class="nt">app</span><span class="p">:</span>
    <span class="nt">handler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lambda.app</span>
    <span class="nt">timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
  <span class="nt">proxy</span><span class="p">:</span>
    <span class="nt">handler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lambda.proxy</span>
    <span class="nt">events</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">http</span><span class="p">:</span> <span class="s">&#39;ANY</span><span class="nv"> </span><span class="s">{proxy+}&#39;</span>
</pre></div>

<h2 id="get-a-lambda-url">Get a Lambda URL</h2>
<p>To obtain the public URL of your new chat bot, you must deploy to AWS. This URL is essential as it will be used to tell RingCentral where to post webhooks and notifications when users install and interact with your bot. </p>
<div class="codehilite"><pre><span></span>npx sls deploy
</pre></div>

<h2 id="update-envyml">Update .env.yml</h2>
<p>Once the project is successfully deployed, a Lambda URL will be provisioned to you. Now, edit the <code>.env.yml</code> file and set <code>RINGCENTRAL_CHATBOT_SERVER</code> to this URL. It should be in the form of:</p>
<blockquote>
<p>https://xxxxxx.execute-api.yyyy.amazonaws.com/prod</p>
</blockquote>
<h2 id="redeploy-to-aws">Redeploy to AWS</h2>
<p>We must redeploy the bot after we edit <code>env.yml</code>:</p>
<div class="codehilite"><pre><span></span>npx sls deploy
</pre></div>

<h2 id="set-the-oauth-redirect-uri">Set the "OAuth Redirect URI"</h2>
<p>Login to https://developer.ringcentral.com, navigate to your bot app, and open the "Settings" tab. Then set "OAuth Redirect URI" to your bot's OAuth endpoint. The URL is your Lambda URL plus "/prod/bot/oauth". For example:</p>
<blockquote>
<p>https://xxxxxx.execute-api.yyyyy.amazonaws.com/prod/bot/oauth</p>
</blockquote>
<h2 id="initialize-the-database">Initialize the Database</h2>
<p>With your bot setup and deployed, we need to initialize the database by creating the database tables needed to manage the bot's state, and persist the many auth tokens, and subscriptions needed to keep your bot up and running. </p>
<div class="codehilite"><pre><span></span>curl -X PUT -u admin:password https://&lt;chatbot-server&gt;/prod/admin/setup-database
</pre></div>

<p>The access credentials (<code>-u admin:password</code>) are defined in the <code>env.yml</code> file we created above.</p>
<h2 id="install-and-test-the-bot">Install and Test the Bot</h2>
<p>Once all of the above is complete, open your Bot in the RingCentral Developer Console. Click "Bot" in the left-hand menu. Set your bot name, then click the button "Add to Glip." Then login to the Glip Sandbox to test. </p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>Our community has shared some of these troubleshooting experiences, feel free to add your own.</p>
<ul>
<li>AWS Lambda connects AWS RDS issue<ul>
<li>If you create an RDS manually and let it create a new security group for you.<ul>
<li>By default, the security group only allows inbound traffic from your current laptop's public IP address</li>
<li>AWS Lambda by default cannot access the newly created AWS RDS</li>
<li>We need to update security group to allow inbound traffic from <code>0.0.0.0/0</code></li>
</ul>
</li>
</ul>
</li>
<li>AWS Lambda and <code>await</code> issue<ul>
<li>AWS Lambda is stateless and it won't keep a background task running</li>
<li>So if your code is async, DO remember to use <code>await</code>. Otherwise that code will not be executed before Lambda invocation terminates</li>
<li>I forgot to <code>await</code>, a weird phenomenon was: whenever I issued a command, I always got reply of previous command</li>
</ul>
</li>
<li>AWS Lambda global code dead-lock issue<ul>
<li>Do NOT invoke lambda functions in global code outside of handlers</li>
<li>I tried once and it seemed to case dead-lock. Lots of requests which causes 429 error and database connection exhausted<ul>
<li>In global code I did <code>axio.put('https://&lt;bot-server&gt;/admin/maintain')</code> and it caused dead-lock</li>
</ul>
</li>
</ul>
</li>
</ul>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <li class="last-updated-holder displayDate loading">
    <span class="last-updated-text">Last updated:</span>
    <time role="presentation" datetime="2018-10-25T00:00:00.000Z" data-article-date-source="ms.date"></time>
  </li>
<!--
  <li class="readingTime">
    2 minutes to read
  </li>
-->
  <li class="contributors-holder">
    <span class="contributors-text">Contributors</span>
    <ul class="contributors" data-bi-name="contributors"></ul>
  </li>
</ul>
</div>
      <div id="sidebar-toc" class="sidebar col-md-2">
	<nav id="toc" data-toggle="toc" class="sticky-top sticky-offset"></nav>
      </div>
    </div>
    </div><footer class="col-md-12">
  <nav class="container">
    <div class="row row-1">
      <div class="col-6">
	<a class="brand nav-link" href="http://developers.ringcentral.com/">Back to main site</a>
      </div>
      <div class="col-6">
	<ul class="nav flex-row ml-md-auto d-none d-md-flex pull-right">
	  <li class="nav-item"><a class="nav-link" href="http://www.ringcentral.com/legal.html">Legal</a></li>
	  <li class="nav-item"><a class="nav-link" href="https://www.ringcentral.com/legal/privacy-notice.html">Privacy Notice</a></li>
	  <li class="nav-item"><a class="nav-link" href="https://devcommunity.ringcentral.com/">Community</a></li>
	  <li class="nav-item"><a class="nav-link" href="https://medium.com/ringcentral-developers">Blog</a></li>
	</ul>
      </div>
    </div>
    <div class="row">
      <div class="col-6">
	<p>&copy;Copyright 2019 RingCentral Inc.</p>
      </div>
      <div class="col-6">
	<ul class="nav flex-row ml-md-auto d-none d-md-flex pull-right">
	  <li><a class="nav-link footer-image-link footer-image-link-facebook" href="http://www.facebook.com/ringcentral">
	      <i class="fa fa-facebook"></i></a></li>
	  <li><a class="nav-link footer-image-link footer-image-link-twitter" href="http://twitter.com/ringcentraldevs">
	      <i class="fa fa-twitter"></i></a></li>
	  <li><a class="nav-link footer-image-link footer-image-link-linkedin" href="http://www.linkedin.com/company/ringcentral">
	      <i class="fa fa-linkedin"></i></a></li>
	  <li><a class="nav-link footer-image-link footer-image-link-youtube" href="http://www.youtube.com/ringcentral">
	      <i class="fa fa-youtube"></i></a></li>
	</ul>
      </div>
  </nav>
</footer>
    <script>
      var base_url = "../..",
          shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" defer></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" defer></script>
    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js" defer></script>
    <script src="../../js/base.js" defer></script>
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" data-toc-skip>Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th scope="col">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    
  </body>
</html>
